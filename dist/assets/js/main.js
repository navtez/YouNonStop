/*!
*
* YouNonStop - v0.1.0 - 2014-02-26 
*
* Copyright 2014 Navtez Singh 
*
*/


function onYouTubePlayerReady(a){younonstop=window.YouNonStop,younonstop.onPlayerReady.call(younonstop,a)}function onYouTubePlayerStateChange(a){younonstop=window.YouNonStop,younonstop.onPlayerStateChange.call(younonstop,a)}function onError(a){younonstop=window.YouNonStop,younonstop.onPlayerStateChange.call(younonstop,a)}!function(a,b,c,d){"undefined"==typeof swfobject&&"undefined"!=typeof google&&"object"==typeof google&&google.load("swfobject","2.2");var e={playerStates:{UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5},keyCodes:{LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,PLAYPAUSE:" ".charCodeAt(0),MUTE0:"M".charCodeAt(0),MUTE1:"m".charCodeAt(0),FULLSCREEN0:"F".charCodeAt(0),FULLSCREEN1:"f".charCodeAt(0),REPEAT0:"R".charCodeAt(0),REPEAT1:"r".charCodeAt(0)},init:function(b,c,e,f,g,h){var i=this;return this.initDbg(),this.player=d,this.playerElement=c,this.playerElementID=c.attr("id"),this.playerControls=e,this.navBar=f,this.searchInput=g,this.currentVideo="",this.searchResults=[],this.repeat=!1,this.uiVisibilty=!0,this.firstMouseMove=0,this.bindEvents(),this.dataApiParams=d,this.suggestionsApiParams=d,this.query=h,this.suggestion=d,this.prevQuery="",this.searchInput.val(this.getHash()||this.query),this.options=a.extend({},a.fn.loadYouNonStop.options,b),this.loadPlayer()?(this.playerControls.on("click","a",function(){i.mouseController.apply(i,arguments)}),this):void 0},bindEvents:function(){this.searchInput.on("keyup",this.search),a("body").mousemove(this.mouseMoveEvent),a("body").on("keyup",this.keyboardEvent),a(b).resize(this.resizeEvent)},mouseMoveEvent:function(a){var b=e;b.debug("mouseMoveEvent: Mouse Moved!"),b.toggleUI("mouse",a)},keyboardEvent:function(a){var b=e,c=b.keyCodes;switch(b.debug("keyboardEvent: Key Pressed "+a.keyCode),b.debug(a),a.keyCode){case c.LEFT_ARROW:case c.RIGHT_ARROW:case c.PLAYPAUSE:case c.MUTE0:case c.MUTE1:case c.FULLSCREEN0:case c.FULLSCREEN1:case c.REPEAT0:case c.REPEAT1:b.keyboardController.call(b,a);case c.UP_ARROW:case c.DOWN_ARROW:default:b.toggleUI("keyboard",a)}},resizeEvent:function(){e.controller("resize")},toggleUI:function(a,b){var c=e,d=1e4,f=b.keyCode;if("keyboard"!==a||f!=c.keyCodes.DOWN_ARROW||(d=100,c.uiVisibilty)){if(clearTimeout(c.uiTimer),c.uiTimer=setTimeout(function(){c.uiVisibilty&&(c.debug("toggleUI: hiding UI"),c.navBar.fadeOut("slow"),c.playerControls.fadeOut("slow"),c.uiVisibilty=!1,c.searchInput.blur(),"mouse"===a&&0===c.firstMouseMove&&c.firstMouseMove++)},d),c.uiVisibilty)return void(f==c.keyCodes.UP_ARROW&&c.searchInput.focus());if("mouse"==a&&1===c.firstMouseMove)return void c.firstMouseMove++;c.debug("toggleUI: showing UI"),c.playerControls.fadeIn("slow"),c.navBar.fadeIn("slow"),c.uiVisibilty=!0}},search:function(b){var c=e,d=c.keyCodes,f=this;"undefined"!=typeof b&&b.keyCode!==d.UP_ARROW&&b.keyCode!==d.DOWN_ARROW&&(c.debug("search: Stopping Propagation"),b.stopPropagation(),c.toggleUI("keyboard",b)),clearTimeout(c.searchTimer),c.searchTimer=f.value.length>=4&&f.value!==c.prevQuery&&setTimeout(function(){c.query=f.value,c.fetchSuggestions().done(function(b){b[1][0]?(c.suggestion=b[1][0][0],c.debug("Suggestion: "+c.suggestion)):c.suggestion=c.query,c.fetchResults().done(function(b){b.data.items&&(c.searchResults=a.map(b.data.items,function(a){return a.id}),c.debug("searchTimer: "+c.searchResults),c.prevQuery=c.query,c.playNext(),c.updateHash())})})},500)},getHash:function(){return b.location.hash?a("<div/>").text(decodeURIComponent(b.location.hash.substring(1))).html():""},updateHash:function(){b.location.replace("#"+encodeURI(this.query))},fetchSuggestions:function(){return apiUrl=this.buildSuggestionsApiURL(),this.debug("fetchSuggestions: "+apiUrl),a.ajax({url:apiUrl,type:"GET",dataType:"jsonp"})},fetchResults:function(){return apiUrl=this.buildDataApiURL(),this.debug("fetchResults: "+apiUrl),a.ajax({url:apiUrl,type:"GET",dataType:"jsonp"})},play:function(a){this.debug("play: "+a),this.player?(this.currentVideo=a,this.player.loadVideoById(a),this.player.playVideo()):this.debug("Unable to find player")},playNext:function(){var a=this.searchResults,b=a.indexOf(this.currentVideo),c=a.length;this.debug("playNext: currentVideo "+this.currentVideo+", index "+b+", length "+c),c&&(b==c-1&&(b=-1),this.play(a[b+1]))},playPrev:function(){var a=this.searchResults,b=a.indexOf(this.currentVideo),c=a.length;this.debug("playPrev: currentVideo "+this.currentVideo+", index "+b+", length "+c),c&&(0===b&&(b=c),this.play(a[b-1]))},loadPlayer:function(){var a=this.options;return"undefined"==typeof swfobject?(this.debug("loadPlayer: Unable to find SWF object!"),!1):(swfobject.embedSWF(a.ytPlayerURL,this.playerElementID,a.playerWidth,a.playerHeight,a.swfVersion,null,null,a.params,a.atts),!0)},buildSuggestionsApiURL:function(b){var c="http://suggestqueries.google.com/complete/search",d="",e="",f=a.fn.loadYouNonStop.suggestionsAPIOptions;if("undefined"!=typeof b&&(f=a.extend(f,b)),"undefined"!=typeof this.suggestionsApiParams)e=this.suggestionsApiParams;else{for(var g in f)e+="&"+g+"="+f[g];this.suggestionsApiParams=e}return d=[c,"?","q=",encodeURIComponent(this.query),e].join(""),this.debug("buildSuggestionsApiURL: "+d),d},buildDataApiURL:function(b){var c="http://gdata.youtube.com/feeds/api/videos",d="",e="",f=a.fn.loadYouNonStop.dataAPIOptions;if("undefined"!=typeof b&&(f=a.extend(f,b)),"undefined"!=typeof this.dataApiParams)e=this.dataApiParams;else{for(var g in f)e+="&"+g+"="+f[g];this.dataApiParams=e}return d=[c,"?","q=",encodeURIComponent(this.suggestion),e].join(""),this.debug("buildDataApiURL: "+d),d},keyboardController:function(a){this.controller(a.keyCode)},mouseController:function(b){var c=a(b.currentTarget);command=c.data("control"),this.debug(b),b.preventDefault(),this.controller(command,c)},controller:function(b,d){var e,f,g=this.player,h=this.keyCodes,i=!1,j=0;if(this.debug("controller: Command: "+b+", Control: "+typeof d),!g)return void this.debug("Unable to find player");switch(b){case"playpause":case h.PLAYPAUSE:e=d||a(this.playerControls).find('[data-control="playpause"]'),f=a(e).find(".fa"),j=g.getPlayerState(),j==this.playerStates.PLAYING?(g.pauseVideo(),f.removeClass("fa-pause").addClass("fa-play")):(j=this.playerStates.PAUSED)&&(g.playVideo(),f.removeClass("fa-play").addClass("fa-pause"));break;case"next":case h.RIGHT_ARROW:this.playNext();break;case"previous":case h.LEFT_ARROW:this.playPrev();break;case"muteunmute":case h.MUTE0:case h.MUTE1:e=d||a(this.playerControls).find('[data-control="muteunmute"]'),f=a(e).find(".fa"),i=g.isMuted(),i?g.unMute():g.mute(),i?f.removeClass("fa-volume-off").addClass("fa-volume-up"):f.removeClass("fa-volume-up").addClass("fa-volume-off");break;case"resize":case"fullscreen":case h.FULLSCREEN0:case h.FULLSCREEN1:e=d||a(this.playerControls).find('[data-control="fullscreen"]'),f=a(e).find(".fa");var k=function(){var a=!(c.fullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement||c.mozFullscreenElement);a?f.removeClass("fa-compress").addClass("fa-expand"):f.removeClass("fa-expand").addClass("fa-compress")};"resize"===b?k():this.toggleFullscreen(k);break;case"repeat":case h.REPEAT0:case h.REPEAT1:e=d||a(this.playerControls).find('[data-control="repeat"]'),f=e.find("#text"),this.repeat=!this.repeat,f.text(this.repeat?"on":"off")}},toggleFullscreen:function(a,b){var d="function"==typeof a?a:!1,e=b||c.documentElement;c.fullscreenElement||c.mozFullScreenElement||c.webkitFullscreenElement||c.mozFullscreenElement?(this.debug("toggleFullScreen: Exiting full screen"),c.exitFullscreen?c.exitFullscreen():c.mozExitFullScreen?c.mozExitFullScreen():c.webkitExitFullscreen?c.webkitExitFullscreen():c.msExitFullscreen&&c.msExitFullscreen()):(this.debug("toggleFullScreen: Entering full screen"),e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):e.msRequestFullscreen&&e.msRequestFullscreen(),setTimeout(function(){c.webkitFullscreenElement||"undefined"!=typeof e.webkitRequestFullscreen&&e.webkitRequestFullscreen(),d&&d()},100)),d&&d()},onPlayerReady:function(a){this.debug("onPlayerReady: "+a),this.player=c.getElementById(a),this.player.addEventListener("onStateChange","onYouTubePlayerStateChange"),this.search.call(this.searchInput[0])},onPlayerStateChange:function(a){{var b=this.searchResults;b.length}this.debug("onPlayerStateChange: "+a),a==this.playerStates.ENDED&&(this.repeat?this.play(this.currentVideo):this.playNext())},onPlayerError:function(a){this.debug("Error: "+a),this.playNext()},initDbg:function(){this.debug="object"==typeof console&&"function"==typeof console.log&&a.fn.loadYouNonStop.DEBUG?function(a){console.log(a)}:function(){}}};a.fn.loadYouNonStop=function(c,d,f,g,h){b.YouNonStop=e.init(c,a(this),d,f,g,h)},a.fn.loadYouNonStop.options={ytPlayerURL:"http://www.youtube.com/apiplayer?enablejsapi=1&playerapiid=ytplayer&version=3&controls=0&scale=0",playerWidth:"425",playerHeight:"356",swfVersion:"9.0.18",params:{allowScriptAccess:"always"},atts:{id:"ytplayer",allowFullScreen:"true"}},a.fn.loadYouNonStop.dataAPIOptions={format:"5","max-results":"10",v:"2",alt:"jsonc"},a.fn.loadYouNonStop.suggestionsAPIOptions={cp:"1",ds:"yt",client:"youtube",hl:"en",hjson:"t"},a.fn.loadYouNonStop.DEBUG=!1}(jQuery,window,document),function(a){var b={codes:{K0:"K".charCodeAt(0),K1:"k".charCodeAt(0),A0:"A".charCodeAt(0),A1:"a".charCodeAt(0),C0:"C".charCodeAt(0),C1:"c".charCodeAt(0),X0:"X".charCodeAt(0),X1:"x".charCodeAt(0)},init:function(a,b,c){this.about=a,this.contact=b,this.shortcuts=c,this.bindModalEvents()},bindModalEvents:function(){var b=this;a("body").on("keyup",function(a){switch(a.keyCode){case b.codes.K0:case b.codes.K1:a.altKey&&(b.about.modal("hide"),b.contact.modal("hide"),b.shortcuts.modal("show"));break;case b.codes.A0:case b.codes.A1:a.altKey&&(b.shortcuts.modal("hide"),b.contact.modal("hide"),b.about.modal("show"));break;case b.codes.C0:case b.codes.C1:a.altKey&&(b.about.modal("hide"),b.shortcuts.modal("hide"),b.contact.modal("show"));break;case b.codes.X0:case b.codes.X1:b.actOnAllModals("hide")}})},actOnAllModals:function(a){this.shortcuts.modal(a),this.about.modal(a),this.contact.modal(a)}};b.init(a("#about"),a("#contact"),a("#shortcuts"))}(jQuery);